<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>External Drive Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
      background-color: #f9f9f9;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    table {
      border-collapse: collapse;
      margin: auto;
      width: 90%;
      background-color: #fff;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    th, td {
      border: 1px solid #ddd;
      padding: 12px 15px;
      text-align: center;
    }
    th {
      background-color: #4CAF50;
      color: white;
    }
    tr:nth-child(even) { background-color: #f2f2f2; }
    tr:hover { background-color: #ddd; }
    .item-cell {
      font-style: italic;
      color: #555;
      text-align: left;
    }
  </style>
</head>
<body>
  <h1>ðŸ“¦ External Drive Dashboard</h1>
  <table id="driveTable">
    <thead></thead>
    <tbody></tbody>
  </table>

  <script>
    const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSK0qK_xqHeCfTWET7uBoBoiR5-ITRLTkRx_LNJTmzmYviynJtal5Q34SHNjG7W7Ov1BvBv7NDfVLpi/pub?output=csv";

    fetch(sheetURL)
      .then(response => response.text())
      .then(data => {
        const rows = data.trim().split('\n').map(row => row.split(','));

        const thead = document.querySelector('#driveTable thead');
        const tbody = document.querySelector('#driveTable tbody');

        // Create table header
        const headerRow = document.createElement('tr');
        rows[0].forEach(header => {
          const th = document.createElement('th');
          th.textContent = header;
          headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);

        // Remember last non-empty drive info
        let lastDrive = "", lastFree = "", lastTotal = "", lastChecked = "";
        rows.slice(1).forEach(row => {
          const [drive, item, free, total, checked] = row;

          const driveVal = drive || lastDrive;
          const freeVal = free || lastFree;
          const totalVal = total || lastTotal;
          const checkedVal = checked || lastChecked;

          if (drive) lastDrive = drive;
          if (free) lastFree = free;
          if (total) lastTotal = total;
          if (checked) lastChecked = checked;

          const tr = document.createElement('tr');

          // Drive cell (show only when drive name present)
          const tdDrive = document.createElement('td');
          tdDrive.textContent = drive ? drive : "";
          tr.appendChild(tdDrive);

          // Item cell (italic sub-category)
          const tdItem = document.createElement('td');
          tdItem.textContent = item;
          tdItem.classList.add("item-cell");
          tr.appendChild(tdItem);

          // Free Space
          const tdFree = document.createElement('td');
          tdFree.textContent = freeVal;
          tr.appendChild(tdFree);

          // Total Space
          const tdTotal = document.createElement('td');
          tdTotal.textContent = totalVal;
          tr.appendChild(tdTotal);

          // Last Checked
          const tdChecked = document.createElement('td');
          tdChecked.textContent = checkedVal;
          tr.appendChild(tdChecked);

          tbody.appendChild(tr);
        });
      })
      .catch(error => {
        document.body.innerHTML += `<p style="color:red; text-align:center;">Failed to load data: ${error}</p>`;
      });
  </script>
</body>
</html>
