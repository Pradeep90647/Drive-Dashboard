<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>External Drive Dashboard (Reliable)</title>
  <style>
    body { font-family: Arial; background: #f4f4f4; padding: 30px; }
    h1 { text-align: center; }
    table { width: 100%; border-collapse: collapse; background: #fff; margin-top: 20px; box-shadow: 0 0 8px rgba(0,0,0,0.1); }
    th, td { padding: 12px; border: 1px solid #ccc; }
    th { background: #4CAF50; color: white; }
    .items { white-space: pre-line; color: #555; font-style: italic; }
  </style>
  <script src="https://www.gstatic.com/charts/loader.js"></script>
  <script>
    google.charts.load('current', { packages: ['table'] });
    google.charts.setOnLoadCallback(drawDashboard);

    function drawDashboard() {
      const query = new google.visualization.Query(
        'https://docs.google.com/spreadsheets/d/1Y75aoCzK-ln1RefEAFFcusuB5qNabRu_dQ1VsbZEE1k/gviz/tq?sheet=Sheet1'
      );
      query.send(handleQueryResponse);
    }

    function handleQueryResponse(response) {
      if (response.isError()) {
        document.body.innerHTML += "<p style='color:red;'>Error: " + response.getMessage() + "</p>";
        return;
      }
      const data = response.getDataTable();

      let html = `<table>
        <tr>
          <th>Drive Name</th>
          <th>Free Space</th>
          <th>Total Space</th>
          <th>Last Checked</th>
          <th>Items</th>
        </tr>`;

      for (let i = 0; i < data.getNumberOfRows(); i++) {
        html += `<tr>
          <td>${data.getValue(i, 0) || ''}</td>
          <td>${data.getValue(i, 1) || ''}</td>
          <td>${data.getValue(i, 2) || ''}</td>
          <td>${data.getValue(i, 3) || ''}</td>
          <td class="items">${data.getValue(i, 4) || ''}</td>
        </tr>`;
      }
      html += '</table>';
      document.body.innerHTML += html;
    }
  </script>
</head>
<body>
  <h1>External Drive Dashboard</h1>
</body>
</html>
